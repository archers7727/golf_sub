# 테스트 가이드

## 1. 사전 준비

### 환경 변수 확인
`.env.local` 파일이 올바르게 설정되어 있는지 확인:
```bash
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### 의존성 설치 확인
```bash
pnpm install
```

## 2. 개발 서버 실행

```bash
pnpm dev
```

서버가 시작되면 브라우저에서 `http://localhost:3000` 접속

## 3. 테스트 체크리스트

### 3.1 인증 (Authentication)
- [ ] 로그인 페이지 접속 (`http://localhost:3000/login`)
- [ ] 전화번호 입력 (예: `01012345678`)
- [ ] 비밀번호 입력
- [ ] 로그인 성공 후 대시보드 리다이렉트 확인
- [ ] 사이드바에 사용자 이름과 권한 배지 표시 확인

### 3.2 코스 타임 관리
**페이지**: `http://localhost:3000/course-time`

- [ ] 타임 목록 테이블 렌더링 확인
- [ ] "타임 등록" 버튼 클릭
- [ ] 등록 폼 작성:
  - 골프장 선택
  - 코스 선택
  - 날짜/시간 입력
  - 예약자명 입력
  - 그린피/수수료 입력
- [ ] "등록" 버튼 클릭 후 목록에 추가 확인
- [ ] 타임 수정 (드롭다운 메뉴 → "수정")
- [ ] 타임 삭제 (드롭다운 메뉴 → "삭제")
- [ ] 상태 배지 색상 확인 (판매완료/미판매/타업체마감)

### 3.3 텍스트 뷰 (모바일 최적화)
**페이지**: `http://localhost:3000/course-time/text-view`

- [ ] 날짜별 그룹핑 확인
- [ ] Sticky 헤더 동작 확인 (스크롤 시)
- [ ] 플로팅 액션 버튼 표시 (새로고침, 등록)
- [ ] 모바일 반응형 레이아웃 확인 (브라우저 창 크기 조정)

### 3.4 예약 관리
**페이지**: `http://localhost:3000/reservation`

- [ ] 예약 카드 목록 렌더링 확인
- [ ] 조인 현황 (1-4번 슬롯) 표시 확인
- [ ] "상세 보기" 버튼 클릭
- [ ] 예약 상세 페이지 (`/reservation/detail?timeId=xxx`) 이동
- [ ] 조인 추가 폼 작성:
  - 고객명 입력
  - 전화번호 입력
  - 입금액 입력
- [ ] 조인 추가 버튼 클릭 후 슬롯에 추가 확인
- [ ] 조인 삭제 버튼 클릭 후 슬롯 비움 확인

### 3.5 블랙리스트 관리
**페이지**: `http://localhost:3000/black-list`

- [ ] 블랙리스트 테이블 렌더링 확인
- [ ] "블랙리스트 추가" 버튼 클릭
- [ ] 추가 다이얼로그 작성:
  - 이름 입력
  - 전화번호 입력
  - 사유 입력
- [ ] "추가" 버튼 클릭 후 목록에 추가 확인
- [ ] 검색 기능 테스트 (이름 또는 전화번호)
- [ ] 삭제 버튼 클릭 후 목록에서 제거 확인

### 3.6 내 실적 조회
**페이지**: `http://localhost:3000/my-performance`

- [ ] 기간 선택 (시작일/종료일)
- [ ] "조회" 버튼 클릭
- [ ] 통계 카드 3개 표시 확인:
  - 총 판매액
  - 총 수수료
  - 판매 건수
- [ ] 판매 내역 테이블 렌더링 확인
- [ ] 상태별 배지 색상 확인 (입금완료/입금확인중 등)

### 3.7 사이트ID 현황
**페이지**: `http://localhost:3000/site-id-status`

- [ ] 골프장별 카드 렌더링 확인
- [ ] 지역별 필터 버튼 클릭 (전체/경기북부/경기남부 등)
- [ ] 사이트ID 목록 표시 확인
- [ ] 활성/비활성 상태 표시 확인
- [ ] 전체 통계 카드 표시 확인 (총 골프장, 총 사이트ID, 활성 사이트ID)

### 3.8 관리자 기능 (Admin 권한 필요)

#### 유저 관리
**페이지**: `http://localhost:3000/admin/manage-users`

- [ ] 유저 목록 테이블 렌더링 확인
- [ ] "유저 추가" 버튼 클릭
- [ ] 추가 다이얼로그 작성:
  - 전화번호 입력
  - 비밀번호 입력
  - 이름 입력
  - 권한 선택 (Manager/Admin)
  - 수수료율 입력
- [ ] "추가" 버튼 클릭 후 목록에 추가 확인
- [ ] 유저 수정 (드롭다운 메뉴 → "수정")
- [ ] 유저 삭제 (드롭다운 메뉴 → "삭제")

#### 사이트ID 관리
**페이지**: `http://localhost:3000/admin/manage-site-ids`

- [ ] 사이트ID 목록 테이블 렌더링 확인
- [ ] "사이트ID 추가" 버튼 클릭
- [ ] 추가 다이얼로그 작성:
  - 골프장 선택
  - 사이트ID 입력
  - 이름 입력
- [ ] "추가" 버튼 클릭 후 목록에 추가 확인
- [ ] 활성화/비활성화 토글 클릭
- [ ] 수정 및 삭제 기능 확인

#### 입금 관리
**페이지**: `http://localhost:3000/admin/deposit`

- [ ] 탭 구조 확인 (입금 대기, 환불 대기, 완료 내역)
- [ ] 입금 대기 탭:
  - [ ] 입금 대기 목록 표시 확인
  - [ ] "승인" 버튼 클릭 후 상태 변경 확인
  - [ ] "대기" 버튼 클릭 후 상태 변경 확인
- [ ] 환불 대기 탭:
  - [ ] 환불 대기 목록 표시 확인
  - [ ] "승인" 버튼 클릭 후 환불 완료 확인
- [ ] 완료 내역 탭:
  - [ ] 완료된 입금/환불 목록 표시 확인
- [ ] 통계 카드 표시 확인 (입금 대기, 환불 대기, 최근 완료)

#### 전체 실적 조회
**페이지**: `http://localhost:3000/admin/performance`

- [ ] 기간 선택 (시작일/종료일)
- [ ] "조회" 버튼 클릭
- [ ] 전체 통계 카드 4개 표시 확인:
  - 총 매니저
  - 총 판매액
  - 총 수수료
  - 총 건수
- [ ] 매니저별 실적 테이블 렌더링 확인
- [ ] 골프장별 실적 테이블 렌더링 확인

### 3.9 권한별 메뉴 표시

#### Manager 권한 로그인 시
사이드바에 다음 메뉴만 표시되어야 함:
- [ ] 대시보드
- [ ] 타임 등록
- [ ] 코스 타임 관리
- [ ] 텍스트 뷰
- [ ] 예약 관리
- [ ] 블랙리스트
- [ ] 내 실적 조회
- [ ] 사이트ID 현황

#### Admin 권한 로그인 시
Manager 메뉴 + 관리자 메뉴 표시:
- [ ] 유저 관리
- [ ] 사이트ID 관리
- [ ] 입금 관리
- [ ] 전체 실적 조회

### 3.10 로그아웃
- [ ] 사이드바 하단 "로그아웃" 버튼 클릭
- [ ] 로그인 페이지로 리다이렉트 확인
- [ ] 다시 대시보드 접속 시도 → 로그인 페이지로 리다이렉트 확인

## 4. 빌드 테스트

### 프로덕션 빌드 확인
```bash
pnpm build
```

- [ ] 빌드 성공 (Exit code 0)
- [ ] TypeScript 에러 없음
- [ ] ESLint 경고/에러 확인

### 프로덕션 서버 실행
```bash
pnpm start
```

- [ ] 서버 정상 시작
- [ ] `http://localhost:3000` 접속 확인

## 5. 린트 테스트

```bash
pnpm lint
```

- [ ] ESLint 실행 성공
- [ ] 에러 확인 및 수정 (필요 시)

## 6. 일반적인 문제 해결

### 로그인 실패
- `.env.local` 파일의 Supabase URL과 Anon Key 확인
- Supabase Dashboard → Authentication에서 사용자 존재 여부 확인
- `users` 테이블에 해당 사용자의 프로필 존재 여부 확인

### 데이터가 표시되지 않음
- Supabase Dashboard → Table Editor에서 데이터 존재 여부 확인
- 브라우저 개발자 도구 → Network 탭에서 API 응답 확인
- RLS 정책이 올바르게 적용되었는지 확인

### 페이지 접근 불가 (403/404)
- 로그인 상태 확인
- 권한 확인 (Admin 페이지는 Admin 권한 필요)
- `middleware.ts`의 라우트 매칭 규칙 확인

### 빌드 에러
- `node_modules` 삭제 후 재설치: `rm -rf node_modules && pnpm install`
- TypeScript 에러 확인: `pnpm tsc --noEmit`
- `.next` 폴더 삭제 후 재빌드: `rm -rf .next && pnpm build`

## 7. 테스트 데이터 추가

Supabase Dashboard → SQL Editor에서 실행:

```sql
-- 골프장 추가
INSERT INTO public.golf_clubs (region, name)
VALUES
  ('경기북부', '테스트 골프클럽'),
  ('경기남부', '샘플 CC');

-- 코스 추가
INSERT INTO public.courses (club_id, region, golf_club_name, course_name)
SELECT id, region, name, '동코스'
FROM public.golf_clubs
WHERE name = '테스트 골프클럽';

-- 사이트ID 추가
INSERT INTO public.site_ids (site_id, name, golf_club_id)
SELECT 'test001', '테스트 사이트ID', id
FROM public.golf_clubs
WHERE name = '테스트 골프클럽';
```

## 8. 완료!

모든 체크리스트 항목이 통과되면 애플리케이션이 정상적으로 작동하는 것입니다.
